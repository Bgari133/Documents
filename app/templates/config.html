{% extends "base.html" %}
{% block title %}Config{% endblock %}
{% block content %}
<h1>Sensitive Data Exposure – Config</h1>
<div class="explanation">
    <strong>What is it?</strong> Sensitive data exposure means the app leaks secrets (API keys, DB URLs, <code>SECRET_KEY</code>, env vars). Attackers use these to impersonate the app, access backends, or forge sessions.
</div>
<details class="hints">
    <summary>Hints (click to expand)</summary>
    <ul>
        <li>This page intentionally shows config and environment. In a real test you might find such data in error messages, <code>/config</code>, <code>/debug</code>, or backup files.</li>
        <li>Try visiting <code>/debug</code>—it raises an exception that may include the <code>SECRET_KEY</code> in the traceback when DEBUG is on.</li>
        <li>Use leaked <code>SECRET_KEY</code> to sign or forge session cookies (e.g. with Flask’s session format). Fix: never expose config/debug in production; use env vars and restrict error pages.</li>
    </ul>
</details>
<div class="exploit-details">
    <p><strong>OWASP:</strong> A02 Cryptographic Failures / A05 Security Misconfiguration</p>
    <p><strong>Impact:</strong> Theft of secrets (API keys, DB URLs, SECRET_KEY); session forgery; access to internal services via env.</p>
    <details><summary>Example exploitation</summary>
        <ul>
            <li>Read SECRET_KEY from this page or from /debug traceback; use it to sign a cookie that sets user_id=1 (admin).</li>
        </ul>
    </details>
    <p><strong>Remediation:</strong> Never expose config or stack traces in production; store secrets in env or secret manager; disable debug mode.</p>
</div>
<h2>Config</h2>
<pre>{% for k, v in config.items() %}{{ k }}: {{ v }}
{% endfor %}</pre>
<h2>Environment</h2>
<pre>{% for k, v in env.items() %}{{ k }}: {{ v }}
{% endfor %}</pre>
{% endblock %}
