{% extends "base.html" %}
{% block title %}Broken Auth{% endblock %}
{% block content %}
<h1>Broken Authentication Lab</h1>
<div class="explanation">
    <strong>What is it?</strong> The app uses weak authentication: plaintext or trivial password checks, default accounts, and no lockout. Your goal: get in without knowing a real password, or enumerate users.
</div>
<details class="hints">
    <summary>Hints (click to expand)</summary>
    <ul>
        <li>Check the README or homepage for default credentials (e.g. admin / admin). Try logging in with those.</li>
        <li>There is no rate limiting—you can try many passwords without being blocked (brute force / credential stuffing would be possible in a real scenario).</li>
        <li>Passwords are compared in plaintext; if you could read the DB (e.g. via SQLi), you’d see them directly.</li>
    </ul>
</details>
<div class="exploit-details">
    <p><strong>OWASP:</strong> A07:2021 Identification and Authentication Failures</p>
    <p><strong>Impact:</strong> Account takeover via default/weak creds, brute force (no rate limit), or credential stuffing; session fixation if applicable.</p>
    <details><summary>Example issues</summary>
        <ul>
            <li>Default credentials: admin / admin (see README)</li>
            <li>No lockout or rate limiting – unlimited password attempts</li>
            <li>Passwords stored and compared in plaintext</li>
        </ul>
    </details>
    <p><strong>Remediation:</strong> Strong password policy; MFA; rate limiting and lockout; bcrypt/Argon2 hashing; no default creds in production.</p>
</div>
{% if error %}<p class="error">{{ error }}</p>{% endif %}
<form method="post">
    <label>Username: <input type="text" name="username" /></label>
    <label>Password: <input type="password" name="password" /></label>
    <button type="submit">Login</button>
</form>
<p><a href="{{ url_for('misc.index') }}">Back</a></p>
{% endblock %}
